This problem must be solved using dynamic programming. Please follow these steps:

1. Determine whether the problem has an optimal substructure and overlapping subproblems.
2. Clearly define the DP state. What parameters uniquely describe a subproblem?
3. Write the recurrence relation (transition formula) that connects larger problems to smaller ones.
4. Identify and explain the base cases of your DP table or recursion.
5. Choose whether to use top-down recursion with memoization or bottom-up tabulation.
6. Carefully handle edge cases and ensure your solution avoids out-of-bound errors.
7. Analyze the time and space complexity of your approach and verify it fits within the constraints.
8. After planning your solution, implement a complete, correct program.
9. Test your code on sample input and ensure all requirements above are met. If not, revise your solution accordingly.